import os
import shutil
import stat

QUARANTINE_ROOT = "quarantine"


def quarantine_file(
    original_path: str,
    sha256_hash: str,
    file_type: str
) -> str:

    quarantine_dir = os.path.join(QUARANTINE_ROOT, file_type)
    os.makedirs(quarantine_dir, exist_ok=True)

    quarantined_path = os.path.join(quarantine_dir, sha256_hash)
    shutil.move(original_path, quarantined_path)

    current_permissions = os.stat(quarantined_path).st_mode
    os.chmod(
        quarantined_path,
        current_permissions & ~stat.S_IXUSR & ~stat.S_IXGRP & ~stat.S_IXOTH
    )

    return quarantined_path
