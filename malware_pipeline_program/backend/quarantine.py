import os
import shutil
import stat

QUARANTINE_ROOT = "quarantine"


def quarantine_file(
    original_path: str,
    sha256_hash: str
) -> str:

    os.makedirs(QUARANTINE_ROOT, exist_ok=True)

    quarantined_path = os.path.join(QUARANTINE_ROOT, sha256_hash)
    shutil.move(original_path, quarantined_path)

    # Remove execute permissions (for safety)
    current_permissions = os.stat(quarantined_path).st_mode
    os.chmod(
        quarantined_path,
        current_permissions
        & ~stat.S_IXUSR
        & ~stat.S_IXGRP
        & ~stat.S_IXOTH
    )

    return quarantined_path
